<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source to the Rust file `/home/runner/work/eviov/eviov/target/debug/build/eviov-1ebd8ae310910c30/out/walkthrough.rs`."><meta name="keywords" content="rust, rustlang, rust-lang"><title>walkthrough.rs.html -- source</title><link rel="stylesheet" type="text/css" href="../../../../../../../../../../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../../../../../../../../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../../../../../../../../../../dark.css"><link rel="stylesheet" type="text/css" href="../../../../../../../../../../../../light.css" id="themeStyle"><script src="../../../../../../../../../../../../storage.js"></script><noscript><link rel="stylesheet" href="../../../../../../../../../../../../noscript.css"></noscript><link rel="shortcut icon" href="../../../../../../../../../../../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../../../../../../../../../../../down-arrow.svg");}</style></head><body class="rustdoc source"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../../../../../../../../../../../eviov/index.html'><div class='logo-container'><img src='../../../../../../../../../../../../rust-logo.png' alt='logo'></div></a></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../../../../../../../../../../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../../../../../../../../../../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../../../../../../../../../../../settings.html"><img src="../../../../../../../../../../../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><pre class="line-numbers"><span id="1">  1</span>
<span id="2">  2</span>
<span id="3">  3</span>
<span id="4">  4</span>
<span id="5">  5</span>
<span id="6">  6</span>
<span id="7">  7</span>
<span id="8">  8</span>
<span id="9">  9</span>
<span id="10"> 10</span>
<span id="11"> 11</span>
<span id="12"> 12</span>
<span id="13"> 13</span>
<span id="14"> 14</span>
<span id="15"> 15</span>
<span id="16"> 16</span>
<span id="17"> 17</span>
<span id="18"> 18</span>
<span id="19"> 19</span>
<span id="20"> 20</span>
<span id="21"> 21</span>
<span id="22"> 22</span>
<span id="23"> 23</span>
<span id="24"> 24</span>
<span id="25"> 25</span>
<span id="26"> 26</span>
<span id="27"> 27</span>
<span id="28"> 28</span>
<span id="29"> 29</span>
<span id="30"> 30</span>
<span id="31"> 31</span>
<span id="32"> 32</span>
<span id="33"> 33</span>
<span id="34"> 34</span>
<span id="35"> 35</span>
<span id="36"> 36</span>
<span id="37"> 37</span>
<span id="38"> 38</span>
<span id="39"> 39</span>
<span id="40"> 40</span>
<span id="41"> 41</span>
<span id="42"> 42</span>
<span id="43"> 43</span>
<span id="44"> 44</span>
<span id="45"> 45</span>
<span id="46"> 46</span>
<span id="47"> 47</span>
<span id="48"> 48</span>
<span id="49"> 49</span>
<span id="50"> 50</span>
<span id="51"> 51</span>
<span id="52"> 52</span>
<span id="53"> 53</span>
<span id="54"> 54</span>
<span id="55"> 55</span>
<span id="56"> 56</span>
<span id="57"> 57</span>
<span id="58"> 58</span>
<span id="59"> 59</span>
<span id="60"> 60</span>
<span id="61"> 61</span>
<span id="62"> 62</span>
<span id="63"> 63</span>
<span id="64"> 64</span>
<span id="65"> 65</span>
<span id="66"> 66</span>
<span id="67"> 67</span>
<span id="68"> 68</span>
<span id="69"> 69</span>
<span id="70"> 70</span>
<span id="71"> 71</span>
<span id="72"> 72</span>
<span id="73"> 73</span>
<span id="74"> 74</span>
<span id="75"> 75</span>
<span id="76"> 76</span>
<span id="77"> 77</span>
<span id="78"> 78</span>
<span id="79"> 79</span>
<span id="80"> 80</span>
<span id="81"> 81</span>
<span id="82"> 82</span>
<span id="83"> 83</span>
<span id="84"> 84</span>
<span id="85"> 85</span>
<span id="86"> 86</span>
<span id="87"> 87</span>
<span id="88"> 88</span>
<span id="89"> 89</span>
<span id="90"> 90</span>
<span id="91"> 91</span>
<span id="92"> 92</span>
<span id="93"> 93</span>
<span id="94"> 94</span>
<span id="95"> 95</span>
<span id="96"> 96</span>
<span id="97"> 97</span>
<span id="98"> 98</span>
<span id="99"> 99</span>
<span id="100">100</span>
<span id="101">101</span>
<span id="102">102</span>
<span id="103">103</span>
<span id="104">104</span>
<span id="105">105</span>
<span id="106">106</span>
<span id="107">107</span>
<span id="108">108</span>
<span id="109">109</span>
<span id="110">110</span>
<span id="111">111</span>
<span id="112">112</span>
<span id="113">113</span>
<span id="114">114</span>
<span id="115">115</span>
<span id="116">116</span>
<span id="117">117</span>
<span id="118">118</span>
<span id="119">119</span>
<span id="120">120</span>
<span id="121">121</span>
<span id="122">122</span>
<span id="123">123</span>
<span id="124">124</span>
<span id="125">125</span>
<span id="126">126</span>
<span id="127">127</span>
<span id="128">128</span>
<span id="129">129</span>
<span id="130">130</span>
<span id="131">131</span>
<span id="132">132</span>
<span id="133">133</span>
<span id="134">134</span>
<span id="135">135</span>
<span id="136">136</span>
<span id="137">137</span>
<span id="138">138</span>
<span id="139">139</span>
<span id="140">140</span>
<span id="141">141</span>
<span id="142">142</span>
<span id="143">143</span>
<span id="144">144</span>
<span id="145">145</span>
<span id="146">146</span>
<span id="147">147</span>
<span id="148">148</span>
<span id="149">149</span>
<span id="150">150</span>
<span id="151">151</span>
<span id="152">152</span>
<span id="153">153</span>
<span id="154">154</span>
<span id="155">155</span>
<span id="156">156</span>
<span id="157">157</span>
<span id="158">158</span>
<span id="159">159</span>
<span id="160">160</span>
<span id="161">161</span>
<span id="162">162</span>
<span id="163">163</span>
<span id="164">164</span>
<span id="165">165</span>
<span id="166">166</span>
<span id="167">167</span>
<span id="168">168</span>
<span id="169">169</span>
<span id="170">170</span>
<span id="171">171</span>
<span id="172">172</span>
<span id="173">173</span>
<span id="174">174</span>
<span id="175">175</span>
<span id="176">176</span>
<span id="177">177</span>
<span id="178">178</span>
<span id="179">179</span>
<span id="180">180</span>
<span id="181">181</span>
<span id="182">182</span>
<span id="183">183</span>
<span id="184">184</span>
<span id="185">185</span>
<span id="186">186</span>
<span id="187">187</span>
<span id="188">188</span>
<span id="189">189</span>
<span id="190">190</span>
<span id="191">191</span>
<span id="192">192</span>
<span id="193">193</span>
<span id="194">194</span>
<span id="195">195</span>
<span id="196">196</span>
<span id="197">197</span>
<span id="198">198</span>
<span id="199">199</span>
<span id="200">200</span>
<span id="201">201</span>
<span id="202">202</span>
<span id="203">203</span>
<span id="204">204</span>
<span id="205">205</span>
<span id="206">206</span>
<span id="207">207</span>
<span id="208">208</span>
<span id="209">209</span>
<span id="210">210</span>
<span id="211">211</span>
<span id="212">212</span>
<span id="213">213</span>
<span id="214">214</span>
<span id="215">215</span>
<span id="216">216</span>
<span id="217">217</span>
<span id="218">218</span>
<span id="219">219</span>
<span id="220">220</span>
<span id="221">221</span>
<span id="222">222</span>
<span id="223">223</span>
<span id="224">224</span>
<span id="225">225</span>
<span id="226">226</span>
<span id="227">227</span>
<span id="228">228</span>
<span id="229">229</span>
<span id="230">230</span>
<span id="231">231</span>
<span id="232">232</span>
<span id="233">233</span>
<span id="234">234</span>
<span id="235">235</span>
<span id="236">236</span>
<span id="237">237</span>
<span id="238">238</span>
<span id="239">239</span>
<span id="240">240</span>
<span id="241">241</span>
<span id="242">242</span>
<span id="243">243</span>
<span id="244">244</span>
<span id="245">245</span>
<span id="246">246</span>
<span id="247">247</span>
<span id="248">248</span>
<span id="249">249</span>
<span id="250">250</span>
<span id="251">251</span>
<span id="252">252</span>
<span id="253">253</span>
<span id="254">254</span>
<span id="255">255</span>
<span id="256">256</span>
<span id="257">257</span>
<span id="258">258</span>
<span id="259">259</span>
<span id="260">260</span>
<span id="261">261</span>
<span id="262">262</span>
<span id="263">263</span>
<span id="264">264</span>
<span id="265">265</span>
<span id="266">266</span>
<span id="267">267</span>
<span id="268">268</span>
<span id="269">269</span>
<span id="270">270</span>
<span id="271">271</span>
<span id="272">272</span>
<span id="273">273</span>
<span id="274">274</span>
<span id="275">275</span>
<span id="276">276</span>
<span id="277">277</span>
<span id="278">278</span>
<span id="279">279</span>
<span id="280">280</span>
<span id="281">281</span>
<span id="282">282</span>
<span id="283">283</span>
<span id="284">284</span>
<span id="285">285</span>
<span id="286">286</span>
<span id="287">287</span>
<span id="288">288</span>
<span id="289">289</span>
<span id="290">290</span>
<span id="291">291</span>
<span id="292">292</span>
<span id="293">293</span>
<span id="294">294</span>
<span id="295">295</span>
<span id="296">296</span>
<span id="297">297</span>
<span id="298">298</span>
<span id="299">299</span>
</pre><div class="example-wrap"><pre class="rust ">
<span class="doccomment">/// Project walkthrough.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// This article guides through all aspects (including technical and gameplay) of</span>
<span class="doccomment">/// this project.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Note that this file is intended as technical reference, not a gameplay guide.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// # Project structure</span>
<span class="doccomment">/// The client is a static page running a WASM module.</span>
<span class="doccomment">/// The source code of the WASM module is located in the /client directory.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// The client may connect to arbitrary servers.</span>
<span class="doccomment">/// Different types of servers expose different gamemodes,</span>
<span class="doccomment">/// and the common code they share is located in the /server directory.</span>
<span class="doccomment">/// Different servers may connect to each other (details explained below),</span>
<span class="doccomment">/// forming a possibly-disconnected graph.</span>
<span class="doccomment">/// Various gamemodes are implemented in crated under the /games directory.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// There are other direct/indirect library crates in the root directory</span>
<span class="doccomment">/// for code that are shared between server and client.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// # Game mechanics</span>
<span class="doccomment">/// The primary focus of this game is the mechanics arising from gravitational pull</span>
<span class="doccomment">/// in a 2D world.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Hierarchical orbital systems</span>
<span class="doccomment">/// This game does not implement real-life n-bodies mechanics.</span>
<span class="doccomment">/// Instead, apart from the root object (nicknamed the &quot;Sun&quot;) which is stationary,</span>
<span class="doccomment">/// every object (the &quot;child&quot;) orbits exactly one other object (the &quot;parent&quot;),</span>
<span class="doccomment">/// and its motion relative to the parent is only influenced by its parent.</span>
<span class="doccomment">/// Here, an &quot;object&quot; refers to anything that participates in the orbital motion,</span>
<span class="doccomment">/// no matter parent or child.</span>
<span class="doccomment">/// The only visible things that are not &quot;objects&quot; are either pure-cosmetic</span>
<span class="doccomment">/// (such as the background texture of the game),</span>
<span class="doccomment">/// or part of an object tightly connected together (such that they move together).</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// To be precise, each &quot;large body&quot;</span>
<span class="doccomment">/// (object that can exert gravitational pull on other objects) has a circular</span>
<span class="doccomment">/// &quot;gravitational field&quot; (abbreviated as &quot;g-field&quot;) centered at its body.</span>
<span class="doccomment">/// All large bodies have a finite radius (except possibly a Sun that should</span>
<span class="doccomment">/// logically never be a child).</span>
<span class="doccomment">/// If an object has zero acceleration and stays in the g-field of its parent,</span>
<span class="doccomment">/// the locus of an object should be an ellipse with a focus at the parent,</span>
<span class="doccomment">/// and the motion should be consistent with Kepler&#39;s laws of planetary motion,</span>
<span class="doccomment">/// relative to its parent, with a small tolerance of computational error.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// A &quot;System&quot; refers to a large body and the external abstraction of its bodies.</span>
<span class="doccomment">/// Each System is processed in its own coroutine.</span>
<span class="doccomment">/// Different Systems might be processed on coroutines run on separate threads,</span>
<span class="doccomment">/// separate processes or even separate machines.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// For &quot;small bodies&quot; (objects that are not large bodies),</span>
<span class="doccomment">/// its logic is entirely handled by the System of its parent body.</span>
<span class="doccomment">/// For large bodies, it should handle its internal logic,</span>
<span class="doccomment">/// but the interaction with its parent should be handled by the parent.</span>
<span class="doccomment">/// The parent should see each large body child as a blackbox,</span>
<span class="doccomment">/// only knowing its g-field radius.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Object transfer</span>
<span class="doccomment">/// When a child escapes the g-field of its parent,</span>
<span class="doccomment">/// it should be &quot;transferred&quot; to the grandparent (the parent of its parent),</span>
<span class="doccomment">/// such that the grandparent becomes the new parent of this child.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// When a child enters the g-field of another child large body of its parent,</span>
<span class="doccomment">/// it should be transferred to the child,</span>
<span class="doccomment">/// such that the other child large body becomes the new parent of this child</span>
<span class="doccomment">/// (and so the original parent becomes the grandparent).</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// In that case, all physical logic of the object should become handled by the</span>
<span class="doccomment">/// new parent.</span>
<span class="doccomment">/// The System of the original parent should send the data about the child to the</span>
<span class="doccomment">/// System of the new parent through the `intra::EntityTransfer` message.</span>
<span class="doccomment">/// If the child is a large body, the old parent System should send an</span>
<span class="doccomment">/// `intra::StartTransfer` message before starting the transfer,</span>
<span class="doccomment">/// and the new parent System should send an `intra::EndTransfer` message</span>
<span class="doccomment">/// after completing the transfer setup.</span>
<span class="doccomment">/// If the new System wants to immediately transfer the child object to another</span>
<span class="doccomment">/// System (e.g. if the g-field of one of the child large bodies of the new parent</span>
<span class="doccomment">/// intersects with the g-field of the old parent),</span>
<span class="doccomment">/// it should perform the new transfer after sending the first `intra::EndTransfer`</span>
<span class="doccomment">/// message.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Netsplits</span>
<span class="doccomment">/// In the whole network, there might be multiple Suns.</span>
<span class="doccomment">/// However, since there is no way for objects under different Suns to interact,</span>
<span class="doccomment">/// generally speaking, we assume there is only one Sun.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// When the coroutine running a parent happens to have crashed, a netsplit occurs.</span>
<span class="doccomment">/// Each of its children becomes a Sun, not connected to other children,</span>
<span class="doccomment">/// nor to the grandparent system (the parent of the crashed parent).</span>
<span class="doccomment">/// The new Sun, since it should have a finite g-field, should perform &quot;smooth</span>
<span class="doccomment">/// collision&quot; (as defined below) on children approaching the boundary of its</span>
<span class="doccomment">/// g-field.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// When the coroutine running a child happens to have crashed,</span>
<span class="doccomment">/// the child should still be handled as a blackbox,</span>
<span class="doccomment">/// but the parent should stop transferring objects into the child.</span>
<span class="doccomment">/// Objects intersecting with the child g-field should perform &quot;smooth collision&quot;.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// &quot;Smooth collision&quot; is a mechanism similar to car-racing games bumping onto the</span>
<span class="doccomment">/// roadbank, where the velocity component parallel to the radius is removed,</span>
<span class="doccomment">/// such that the object only moves along the circumference.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Distant view</span>
<span class="doccomment">/// Players have infinite Field of View, i.e. they can zoom out indefinitely.</span>
<span class="doccomment">/// However, due to diffraciton of light,</span>
<span class="doccomment">/// objects further away have reduced &quot;resolution&quot;,</span>
<span class="doccomment">/// i.e. players can only see bigger objects at a distance.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// &gt; (The following feature might not be implemented)</span>
<span class="doccomment">/// &gt;</span>
<span class="doccomment">/// &gt; In addition, due to relativity, objects seen far away would delay in time.</span>
<span class="doccomment">/// &gt; For example, if a spacecraft spawns at a location 8*c* away,</span>
<span class="doccomment">/// &gt; it would appear on the client after 8 seconds.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// # Protocol</span>
<span class="doccomment">/// In this section, a &quot;node&quot; refers to a party that can send or receive messages.</span>
<span class="doccomment">/// A node can be a client, the communications manager of a server process, a</span>
<span class="doccomment">/// System coroutine, or &quot;Hub servers&quot;.</span>
<span class="doccomment">/// A Hub server is a logical server that handles non-physical events,</span>
<span class="doccomment">/// such as player score, load balancing, etc.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// All communications go through the `Router`, which manages the internal and</span>
<span class="doccomment">/// external communication routing.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// For each communication, there is a &quot;server&quot; endpoint and a &quot;client&quot; endpoint.</span>
<span class="doccomment">/// Before the connection is created, the server first listens at a &quot;node address&quot;</span>
<span class="doccomment">/// (an object ID for internal, a server address plus an object ID for external).</span>
<span class="doccomment">/// The client requests through the router (or two routers for external) to connect</span>
<span class="doccomment">/// to a server.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Data are exchanged in units of messages.</span>
<span class="doccomment">/// Messages of the similar type are grouped as the same endpoint of a &quot;protocol&quot;.</span>
<span class="doccomment">/// Multiple protocols can be grouped as a &quot;protocol aggregate&quot;,</span>
<span class="doccomment">/// which shares the same identification information and reuses the connection.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// When an external connection is created, the server sends a challenge query to</span>
<span class="doccomment">/// the client.</span>
<span class="doccomment">/// This can be an empty query, but it must be sent even if empty.</span>
<span class="doccomment">/// The client then sends a reply (based on the query or otherwise).</span>
<span class="doccomment">/// If the server accepts the query, it replies with a `ChallengeResult::Ok`</span>
<span class="doccomment">/// message, otherwise `ChallengeResult::Fail` and closes the connection.</span>
<span class="doccomment">/// Then, protocol-specific messages can be transferred through the aggregate</span>
<span class="doccomment">/// wrapper packets.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Time synchronization</span>
<span class="doccomment">/// Time synchronization is used to synchronize the &quot;game time&quot; between processes.</span>
<span class="doccomment">/// Game time is represented as number of &quot;ticks&quot; (1 tick = 20ms, 50 ticks = 1s)</span>
<span class="doccomment">/// since the &quot;Universal Epoch&quot;, which is the instant when the first node in the</span>
<span class="doccomment">/// network started.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Since nodes in the same process have the same system clock,</span>
<span class="doccomment">/// Time synchronization only happens between nodes of different processes/machines.</span>
<span class="doccomment">/// In addition, to avoid overloading,</span>
<span class="doccomment">/// the server side of time synchronization can be System coroutines.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Clients should only perform time synchronization with System servers.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Request</span>
<span class="doccomment">/// The request contains a random `id` field.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Response</span>
<span class="doccomment">/// The response contains the `id` from the request,</span>
<span class="doccomment">/// as well as the `time`, the current game time.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Client-system connection</span>
<span class="doccomment">/// Client-system connection is the wrapper protocol for multiple types</span>
<span class="doccomment">/// (&quot;channels&quot;)</span>
<span class="doccomment">/// of communication between the client and Systems.</span>
<span class="doccomment">/// Systems in the same process communicate with the same client using the same</span>
<span class="doccomment">/// websocket.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Observer channel</span>
<span class="doccomment">/// The observer channel allows authorized clients to listen to events happening</span>
<span class="doccomment">/// within the System.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Handshake</span>
<span class="doccomment">/// When a client is allowed to start listening to events in a System</span>
<span class="doccomment">/// (most likely authorized by the parent or child of the System),</span>
<span class="doccomment">/// the System and the authorizer indirectly exchange an</span>
<span class="doccomment">/// `intra::AllowObserve` message.</span>
<span class="doccomment">/// `intra::AllowObserve::Response::token` is forwarded to the client,</span>
<span class="doccomment">/// which uses the token to perform observer handshake to this System</span>
<span class="doccomment">/// through the `cs::obs::Handshake::Request` message.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Accept</span>
<span class="doccomment">/// If the System accepts the handshake, it responds with a</span>
<span class="doccomment">/// `cs::obs::Handshake::Response` message.</span>
<span class="doccomment">/// The response message contains the components of the center large body of the</span>
<span class="doccomment">/// System, as well as the external traits of its children.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Event</span>
<span class="doccomment">/// The `cs::obs::Event` message encapsulates events happening in the System.</span>
<span class="doccomment">/// For example, `cs::obs::EventContent::Accel` sets the gravity-independent</span>
<span class="doccomment">/// acceleration of a child object.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Termination</span>
<span class="doccomment">/// When the authorization to listen to events is revoked,</span>
<span class="doccomment">/// the authorizer sends an `intra::RevokeObserve` message to the System.</span>
<span class="doccomment">/// Then the System would send a `cs::obs::Close` message to the client and close</span>
<span class="doccomment">/// the connection.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Controller channel</span>
<span class="doccomment">/// For gamemodes where the player controls a private object (&quot;spacecraft&quot;),</span>
<span class="doccomment">/// the controller channel allows the player to toggle spacecraft controls.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Controller channel takes place bteween the controlling client and the System</span>
<span class="doccomment">/// that handles the spacecraft.</span>
<span class="doccomment">/// If the spacecraft is transferred to another System,</span>
<span class="doccomment">/// the Controller channel is closed, and the client should create one in the new System.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Unresolved: what if two transfers happen in a short period of time?</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Handshake</span>
<span class="doccomment">/// A client gains access to a spacecraft by providing its ID and password</span>
<span class="doccomment">/// through the `cs::ctrl::Handshake::Request` message.</span>
<span class="doccomment">/// The password is a random `u64` generated by the server,</span>
<span class="doccomment">/// and provided to the client most likely during game join.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Accept</span>
<span class="doccomment">/// If the System accepts the handshake, it responds with a</span>
<span class="doccomment">/// `cs::ctrl::Handshake::Response` message.</span>
<span class="doccomment">/// This message provides information of various controls of the spacecraft.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// #### Control</span>
<span class="doccomment">/// The `cs::ctrl::Control` message encapsulates client actions to update the</span>
<span class="doccomment">/// spacecraft controls.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// The `cs::ctrl::Update` message encapsulates events in the System</span>
<span class="doccomment">/// (such as changes in energy levels)</span>
<span class="doccomment">/// that only the rocket controller should receive.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Client-hub connection</span>
<span class="doccomment">/// This connection exchanges information about general public data and</span>
<span class="doccomment">/// player-specific data, such as online server list, accumulated score, etc.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Intra-system connection</span>
<span class="doccomment">/// This connection exchanges information about object transfers.</span>
<span class="doccomment">/// Since object transfer can only occur between parent and children,</span>
<span class="doccomment">/// the connection only exists at this level.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Object transfer</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Observer authorization</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## System-hub connection</span>
<span class="doccomment">/// This connection allows Systems to retrieve and update persistent data about</span>
<span class="doccomment">/// players, such as player accumulated score.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// # Gamemodes</span>
<span class="doccomment">/// Adding more gamemodes is a late stage of development.</span>
<span class="doccomment">/// In early stage, only the simplest Basic FFA mode is implemented.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Basic FFA</span>
<span class="doccomment">/// Players join in one-time sessions (no progress is retained).</span>
<span class="doccomment">/// Players are attached to a specific &quot;spacecraft&quot; (a type of small body),</span>
<span class="doccomment">/// and control its acceleration in a restricted range.</span>
<span class="doccomment">/// The spacecraft can produce &quot;missiles&quot; (another type of small body),</span>
<span class="doccomment">/// ejected with a specific initial velocity.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Durability</span>
<span class="doccomment">/// Both spacecrafts and missiles have &quot;durability&quot; (a type of scalar value).</span>
<span class="doccomment">/// They disappear when durability reaches zero.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Missiles lose durability over time.</span>
<span class="doccomment">/// Spacecrafts also lose durability over time (at an quadratic increasing rate)</span>
<span class="doccomment">/// if there is no player controlling it.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// When two objects collide (this requires better definition),</span>
<span class="doccomment">/// their durability reduce at a different ratio,</span>
<span class="doccomment">/// as defined by their &quot;resistance value&quot;.</span>
<span class="doccomment">/// In Basic mode, all spacecrafts have the same resistance value,</span>
<span class="doccomment">/// and all missiles have the same resistance value.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ### Environment</span>
<span class="doccomment">/// Around a Sun, there are four planets, initially equally spaced in angle,</span>
<span class="doccomment">/// with different radii from the Sun.</span>
<span class="doccomment">/// Each planet has 2-3 children.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Evo FFA</span>
<span class="doccomment">/// Similar to Basic FFA, but there exists various classes of spacecrafts,</span>
<span class="doccomment">/// allowing variation in acceleration range, rotation speed, durability,</span>
<span class="doccomment">/// resistance value and missile type.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// Different missile types also vary in ejection velocity, durability, resistance</span>
<span class="doccomment">/// value, and possibly other logic.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// All players start with the basic class.</span>
<span class="doccomment">/// Spacecrafts can pick up floating space debris to increase their &quot;energy level&quot;,</span>
<span class="doccomment">/// which can be used to transform the spacecraft into other classes.</span>
<span class="doccomment">/// Energy level can also be increased by destroying other spacecrafts.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// ## Expert FFA</span>
<span class="doccomment">/// Similar to Evo FFA, but there is an additional constraint of fuel.</span>
<span class="doccomment">/// All operations consume fuel, and the player has to pick up hydrogen and oxygen</span>
<span class="doccomment">/// orbs in space in order to refill the fuel.</span>
<span class="doccomment">/// </span>
<span class="doccomment">/// # Client display</span>
<span class="kw">pub</span> <span class="kw">mod</span> <span class="ident">walkthrough</span>{}
</pre></div>
</section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../../../../../../../../../../../";window.currentCrate = "eviov";</script><script src="../../../../../../../../../../../../aliases.js"></script><script src="../../../../../../../../../../../../main.js"></script><script src="../../../../../../../../../../../../source-script.js"></script><script src="../../../../../../../../../../../../source-files.js"></script><script defer src="../../../../../../../../../../../../search-index.js"></script></body></html>